---
layout: default
---

<!-- Responsive Sticky Stacking Styles for Mobile only -->
<!-- No specific CSS class needed as we use Tailwind classes now -->
<section class="px-8 py-20 md:py-24">
    <div class="container mx-auto max-w-7xl">
        <div class="text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-6 text-accent">{{ page.title }}</h1>
        </div>

        <!-- Filter Section -->
        <div class="p-8 rounded-2xl backdrop-blur-sm">
            <div class="flex flex-col gap-6">
                <!-- Search -->
                <div class="w-full relative">
                    <span class="absolute left-5 top-1/2 -translate-y-1/2 text-xl opacity-70">üîç</span>
                    <input type="text" id="search-input"
                        class="w-full pl-14 pr-6 py-4 bg-primary-bg/50 border border-primary-text/30 rounded-full text-primary-text text-lg transition-all focus:outline-none focus:border-accent focus:shadow-glow-sm placeholder-white/20"
                        placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡∏•‡πá‡∏≠‡∏Å...">
                </div>

                <!-- Tags Wrapper -->
                <div class="relative">
                    <div id="tags-wrapper"
                        class="flex flex-wrap gap-3 justify-start overflow-hidden transition-[max-height] duration-500 ease-in-out relative pb-1"
                        style="max-height: 44px;">
                        <div id="category-filters" class="contents">
                            <!-- Category buttons will be generated by JavaScript -->
                        </div>

                        <!-- Gradient Overlay -->
                        <div id="tags-gradient"
                            class="absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-primary-bg to-transparent pointer-events-none transition-opacity duration-300">
                        </div>
                    </div>

                    <!-- Expand/Collapse Button -->
                    <div class="mt-2 flex justify-center hidden" id="tags-toggle-container">
                        <button id="tags-toggle-btn"
                            class="text-primary-text/60 hover:text-accent flex items-center justify-center transition-colors p-2 rounded-full hover:bg-primary-text/5 bg-primary-bg border border-primary-text/10 shadow-sm -mt-4 relative z-10 w-8 h-8">
                            <svg id="tags-toggle-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="transition-transform duration-300">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blog Container -->
        <!-- Mobile: Vertical Stack | Desktop: Grid -->
        <div class="relative max-w-3xl md:max-w-none mx-auto space-y-12 md:space-y-0 pb-24 md:pb-0 md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-8"
            id="all-blogs">
            {% assign pinned_posts = site.posts | where: "pinned", true %}
            {% assign regular_posts = site.posts | where_exp: "post", "post.pinned != true" %}
            {% assign all_posts = pinned_posts | concat: regular_posts %}
            {% for post in all_posts %}
            {% assign rotation = forloop.index | modulo: 3 | minus: 1 | times: 1.5 %}
            {% assign offset = forloop.index | times: 15 %}
            {% assign hover_rotate = forloop.index | modulo: 2 | times: 2 | minus: 1 | times: 2 %}

            <div class="blog-card-container group sticky md:static transition-none"
                style="top: {{ 120 | plus: offset }}px; z-index: {{ forloop.index }};"
                data-original-index="{{ forloop.index }}">
                <div class="transform md:transform-none transition-transform duration-300 
                            {% if post.pinned %}
                            shadow-[0_10px_30px_-5px_rgba(0,0,0,0.5)] md:shadow-[0_10px_30px_-10px_rgba(0,0,0,0.5)]
                            hover:shadow-[0_0_30px_rgba(254,213,118,0.3)]
                            border border-accent/50 rounded-xl
                            {% else %}
                            shadow-xl md:shadow-none md:hover:shadow-lg
                            {% endif %}
                            hover:-translate-y-4 md:hover:-translate-y-2
                            hover:rotate-[{{ hover_rotate }}deg] relative z-20 {% if post.pinned %}group-hover:z-30{% endif %}"
                    style="transform: rotate({{ rotation }}deg);">
                    {% if post.pinned %}
                    <!-- Glow effect background for pinned -->
                    <div
                        class="absolute -inset-1 bg-accent/20 blur-md opacity-0 group-hover:opacity-70 transition-opacity duration-500 rounded-xl -z-10">
                    </div>
                    <div class="bg-card-bg rounded-xl overflow-hidden h-full">
                        {% include blog-card.html post=post %}
                    </div>
                    {% else %}
                    {% include blog-card.html post=post %}
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- No results message -->
        <div id="no-results" class="text-center mt-12 hidden">
            <p class="text-text-muted text-lg">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</p>
        </div>
    </div>
</section>

<script>
    // Blog filtering logic
    const allPostContainers = document.querySelectorAll('#all-blogs .blog-card-container');
    const searchInput = document.getElementById('search-input');
    const categoryFilters = document.getElementById('category-filters');
    const noResults = document.getElementById('no-results');
    const blogsContainer = document.getElementById('all-blogs');
    const tagsWrapper = document.getElementById('tags-wrapper');
    const tagsToggleBtn = document.getElementById('tags-toggle-btn');
    const tagsToggleContainer = document.getElementById('tags-toggle-container');
    const tagsToggleIcon = document.getElementById('tags-toggle-icon');
    const tagsGradient = document.getElementById('tags-gradient');

    let activeCategory = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
    let isTagsExpanded = false;

    // 1. Calculate Category Counts
    const categoryCounts = new Map();
    categoryCounts.set('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', allPostContainers.length);

    allPostContainers.forEach(container => {
        const post = container.querySelector('.blog-card');
        if (!post) return;
        const categoryTags = post.querySelectorAll('.category-tag');
        categoryTags.forEach(tagElement => {
            const tag = tagElement.textContent.trim();
            categoryCounts.set(tag, (categoryCounts.get(tag) || 0) + 1);
        });
    });

    // 2. Render Filter Buttons
    categoryCounts.forEach((count, category) => {
        const btn = document.createElement('button');
        const isActive = category === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
        // Base classes
        let classes = 'filter-btn flex items-center gap-2 whitespace-nowrap ';
        classes += isActive ? 'filter-btn-active' : '';

        btn.className = classes;
        btn.innerHTML = `${category} <span class="bg-primary-text/10 text-[10px] px-1.5 py-0.5 rounded-full opacity-70">${count}</span>`;

        btn.onclick = () => filterByCategory(category);
        categoryFilters.appendChild(btn);
    });

    // 3. Setup Tags Expansion Logic
    function checkTagsOverflow() {
        if (tagsWrapper.scrollHeight > tagsWrapper.clientHeight) {
            tagsToggleContainer.classList.remove('hidden');
            if (!isTagsExpanded) tagsGradient.classList.remove('opacity-0');
        } else {
            if (!isTagsExpanded) {
                tagsToggleContainer.classList.add('hidden');
                tagsGradient.classList.add('opacity-0');
            }
        }
    }

    tagsToggleBtn.addEventListener('click', () => {
        isTagsExpanded = !isTagsExpanded;
        if (isTagsExpanded) {
            tagsWrapper.style.maxHeight = tagsWrapper.scrollHeight + "px";
            tagsToggleIcon.style.transform = "rotate(180deg)";
            tagsGradient.classList.add('opacity-0');
        } else {
            tagsWrapper.style.maxHeight = "44px"; // Default collapsed height
            tagsToggleIcon.style.transform = "rotate(0deg)";
            tagsGradient.classList.remove('opacity-0');
        }
    });

    // Check overflow on load and resize
    window.addEventListener('load', checkTagsOverflow);
    window.addEventListener('resize', () => {
        if (!isTagsExpanded) checkTagsOverflow();
    });
    // Also check immediately after rendering
    setTimeout(checkTagsOverflow, 0);

    function filterByCategory(category) {
        activeCategory = category;

        // Update active button
        const buttons = categoryFilters.querySelectorAll('button');
        buttons.forEach(btn => {
            // Check text node only to match category name (ignoring the count span)
            const btnCategory = btn.childNodes[0].textContent.trim();
            btn.classList.toggle('filter-btn-active', btnCategory === category);
        });

        applyFilters();
    }

    function applyFilters() {
        const searchTerm = searchInput.value.toLowerCase();
        let visibleCount = 0;
        let visibleIndex = 1; // 1-based index for recalculation

        allPostContainers.forEach(container => {
            const post = container.querySelector('.blog-card');
            if (!post) return;

            const title = post.querySelector('h3').textContent.toLowerCase();
            const excerpt = post.querySelector('.text-text-muted').textContent.toLowerCase();
            const categoryTags = Array.from(post.querySelectorAll('.category-tag')).map(tag => tag.textContent.trim());

            // Category filter
            let categoryMatch = activeCategory === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' || categoryTags.includes(activeCategory);

            // Search filter
            let searchMatch = !searchTerm || title.includes(searchTerm) || excerpt.includes(searchTerm) ||
                categoryTags.some(cat => cat.toLowerCase().includes(searchTerm));

            if (categoryMatch && searchMatch) {
                container.style.display = 'block';
                visibleCount++;

                // Recalculate sticky position for Mobile Stack ONLY
                // Desktop uses normal grid flow (static)
                const offset = visibleIndex * 15;
                const top = 120 + offset;
                const rotation = ((visibleIndex % 3) - 1) * 1.5;

                container.style.top = top + 'px';
                container.style.zIndex = visibleIndex;

                // Update inner rotation (for mobile stack effect)
                // Note: Desktop hover rotation is handled by CSS hover:rotate-[Xdeg] classes
                const inner = container.firstElementChild;
                if (inner) {
                    // We only want to enforce rotation style, CSS handles hover
                    inner.style.transform = `rotate(${rotation}deg)`;
                }

                visibleIndex++;
            } else {
                container.style.display = 'none';
            }
        });

        // Show/hide no results message
        if (visibleCount === 0) {
            noResults.classList.remove('hidden');
            blogsContainer.classList.add('hidden');
        } else {
            noResults.classList.add('hidden');
            blogsContainer.classList.remove('hidden');
        }
    }

    searchInput.addEventListener('input', applyFilters);
</script>